<!doctype html>
<html>
<head>
	<title>Amalgamatron</title>
</head>
<body>



<div id="status">connecting....</div>

<script>

	var SoundChannel = function() {
	}
	SoundChannel.prototype = {
		active: false,
		
		play: function(sound) {
		}
	}

	var SoundManager = function(channels) {
		
	}
	var num = 0;
	
	SoundManager.prototype = {
	
		test: 1,
		sounds: {},
	
		add: function(name, opts) {
			if(!this.sounds[name]) {
				var sound = document.createElement("audio");
				sound.setAttribute("src", "media/samples/" + name + ".ogg");
				sound.setAttribute("autobuffer", true);
				this.sounds[name] = sound;
			}
		},
		play: function(name) {
			if(this.sounds[name]) {
				this.sounds[name].play();
			}
		}
	};

	var sm = new SoundManager();
	sm.add("tick");
	sm.add("1");
	sm.add("2");
	sm.add("3");
	sm.add("4");
	sm.add("5");
	sm.add("6");
	sm.add("7");
	sm.add("8");
	
	var webSocket = new WebSocket('ws://192.168.0.2:4000/music');

	webSocket.onopen = function(event){
		document.getElementById('status').innerHTML = 'connected';
	};

	webSocket.onmessage = function(event){
		var obj = JSON.parse(event.data);
		switch(obj.action) {
			case "tick":
				//sm.play("tick");
			case "keydown":
				sm.play(obj.y + 1);
				break;
			default:
				break;
		}
	};

	webSocket.onclose = function(event){
		document.getElementById('status').innerHTML = 'socket closed';
	};

</script>


</body>
</html>